basePath: /
definitions:
  auth.DummyLoginRequest:
    properties:
      role:
        type: string
    required:
    - role
    type: object
  auth.LoginRequest:
    properties:
      email:
        type: string
      password:
        minLength: 6
        type: string
    required:
    - email
    - password
    type: object
  auth.RegisterRequest:
    properties:
      email:
        type: string
      password:
        maxLength: 255
        minLength: 6
        type: string
      role:
        type: string
    required:
    - email
    - password
    - role
    type: object
  auth.RegisterResponse:
    properties:
      email:
        type: string
      id:
        type: string
      role:
        type: string
    type: object
  product.CreateRequest:
    properties:
      pvzId:
        type: string
      type:
        maxLength: 255
        type: string
    required:
    - pvzId
    - type
    type: object
  product.CreateResponse:
    properties:
      dateTime:
        type: string
      id:
        type: string
      receptionId:
        type: string
      type:
        type: string
    type: object
  pvz.CreateRequest:
    properties:
      city:
        maxLength: 255
        type: string
      id:
        type: string
      registrationDate:
        type: string
    required:
    - city
    - id
    - registrationDate
    type: object
  pvz.CreateResponse:
    properties:
      city:
        type: string
      id:
        type: string
      registrationDate:
        type: string
    type: object
  pvz.PVZListResponse:
    properties:
      pvz:
        $ref: '#/definitions/pvz.PvzResponse'
      receptions:
        items:
          $ref: '#/definitions/pvz.ReceptionsWithProduct'
        type: array
    type: object
  pvz.ProductsResponse:
    properties:
      dateTime:
        type: string
      id:
        type: string
      receptionId:
        type: string
      type:
        type: string
    type: object
  pvz.PvzResponse:
    properties:
      city:
        type: string
      id:
        type: string
      registrationDate:
        type: string
    type: object
  pvz.ReceptionsResponse:
    properties:
      dateTime:
        type: string
      id:
        type: string
      pvzId:
        type: string
      status:
        type: string
    type: object
  pvz.ReceptionsWithProduct:
    properties:
      products:
        items:
          $ref: '#/definitions/pvz.ProductsResponse'
        type: array
      reception:
        $ref: '#/definitions/pvz.ReceptionsResponse'
    type: object
  reception.CloseLastReceptionResponse:
    properties:
      dateTime:
        type: string
      id:
        type: string
      pvzID:
        type: string
      status:
        type: string
    type: object
  reception.CreateRequest:
    properties:
      pvzID:
        type: string
    required:
    - pvzID
    type: object
  reception.CreateResponse:
    properties:
      dateTime:
        type: string
      id:
        type: string
      pvzID:
        type: string
      status:
        type: string
    type: object
  response.Empty:
    type: object
  response.Error:
    properties:
      details:
        type: string
      message:
        type: string
    type: object
host: localhost:8080
info:
  contact: {}
  description: Сервис для управления ПВЗ и приемкой товаров
  title: PVZ service
  version: "1.0"
paths:
  /dummyLogin:
    post:
      consumes:
      - application/json
      description: Authenticates a user and returns a JWT token for role.
      operationId: DummyLogin
      parameters:
      - description: User credentials (email and password)
        in: body
        name: input
        required: true
        schema:
          $ref: '#/definitions/auth.DummyLoginRequest'
      produces:
      - application/json
      responses:
        "200":
          description: JWT token issued successfully
          schema:
            type: string
        "400":
          description: Invalid request or validation failed
          schema:
            $ref: '#/definitions/response.Error'
        "401":
          description: Generate token failed
          schema:
            $ref: '#/definitions/response.Error'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/response.Error'
      summary: Dummy login
      tags:
      - Auth
  /login:
    post:
      consumes:
      - application/json
      description: Authenticate user and returns a JWT Bearer token.
      operationId: Login
      parameters:
      - description: User credentials (email and password)
        in: body
        name: input
        required: true
        schema:
          $ref: '#/definitions/auth.LoginRequest'
      produces:
      - application/json
      responses:
        "200":
          description: JWT access token
          schema:
            type: string
        "400":
          description: Invalid request or validation failed
          schema:
            $ref: '#/definitions/response.Error'
        "401":
          description: Invalid email or password
          schema:
            $ref: '#/definitions/response.Error'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/response.Error'
      summary: User login
      tags:
      - Auth
  /products:
    post:
      consumes:
      - application/json
      description: Creates a new product in the PVZ system.
      operationId: CreateProduct
      parameters:
      - description: Product creation payload
        in: body
        name: input
        required: true
        schema:
          $ref: '#/definitions/product.CreateRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Product successfully created
          schema:
            $ref: '#/definitions/product.CreateResponse'
        "400":
          description: No reception is currently in progress
          schema:
            $ref: '#/definitions/response.Error'
        "409":
          description: Product already exists or conflict error
          schema:
            $ref: '#/definitions/response.Error'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/response.Error'
      security:
      - ApiKeyAuth: []
      summary: Create a new product
      tags:
      - Product
  /pvz:
    get:
      description: Get a list of PVZ points with optional filters. Requires JWT-Token
        with Employee or Moderator role.
      parameters:
      - description: Filter by city
        in: query
        name: city
        type: string
      - description: Limit number of results
        in: query
        name: limit
        type: integer
      - description: Page for pagination
        in: query
        name: page
        type: integer
      responses:
        "200":
          description: List of PVZ points
          schema:
            items:
              $ref: '#/definitions/pvz.PVZListResponse'
            type: array
        "400":
          description: Bad request
          schema:
            $ref: '#/definitions/response.Error'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/response.Error'
      security:
      - ApiKeyAuth: []
      summary: List PVZ points
      tags:
      - PVZ
    post:
      consumes:
      - application/json
      description: Create new PVZ. Requires JWT-Token with Employee role.
      operationId: CreatePVZ
      parameters:
      - description: PVZ creation data
        in: body
        name: input
        required: true
        schema:
          $ref: '#/definitions/pvz.CreateRequest'
      produces:
      - application/json
      responses:
        "200":
          description: PVZ successfully created
          schema:
            $ref: '#/definitions/pvz.CreateResponse'
        "400":
          description: Invalid request or validation failed
          schema:
            $ref: '#/definitions/response.Error'
        "404":
          description: City not found
          schema:
            $ref: '#/definitions/response.Error'
        "409":
          description: Pvz with this id already exists
          schema:
            $ref: '#/definitions/response.Error'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/response.Error'
      security:
      - ApiKeyAuth: []
      summary: Create PVZ
      tags:
      - PVZ
  /pvz/{pvzID}/close_last_reception:
    post:
      description: Close the last reception for a given PVZ ID. Requires JWT-Token
        with Employee role.
      operationId: CloseLastReception
      parameters:
      - description: PVZ ID
        in: path
        name: pvzID
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Successfully closed last reception
          schema:
            $ref: '#/definitions/reception.CloseLastReceptionResponse'
        "400":
          description: Invalid or missing PVZ ID
          schema:
            $ref: '#/definitions/response.Error'
        "404":
          description: No open reception found for this PVZ
          schema:
            $ref: '#/definitions/response.Error'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/response.Error'
      security:
      - ApiKeyAuth: []
      summary: Close Last Reception
      tags:
      - PVZ
  /pvz/{pvzID}/delete_last_product:
    post:
      consumes:
      - application/json
      description: Deletes the most recently added product for the given PVZ ID.
      operationId: DeleteLastProduct
      parameters:
      - description: PVZ ID (UUID)
        in: path
        name: pvzID
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Successfully deleted
          schema:
            $ref: '#/definitions/response.Empty'
        "400":
          description: Invalid pvzID format
          schema:
            $ref: '#/definitions/response.Error'
        "409":
          description: No products to delete
          schema:
            $ref: '#/definitions/response.Error'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/response.Error'
      security:
      - ApiKeyAuth: []
      summary: Delete the last product of a PVZ
      tags:
      - PVZ
  /receptions:
    post:
      consumes:
      - application/json
      description: Create a new reception entry. Requires JWT-Token with Employee
        role.
      operationId: CreateReception
      parameters:
      - description: Reception creation data
        in: body
        name: input
        required: true
        schema:
          $ref: '#/definitions/reception.CreateRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Reception successfully created
          schema:
            $ref: '#/definitions/reception.CreateResponse'
        "400":
          description: Invalid request or validation failed
          schema:
            $ref: '#/definitions/response.Error'
        "404":
          description: PVZ not found
          schema:
            $ref: '#/definitions/response.Error'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/response.Error'
      security:
      - ApiKeyAuth: []
      summary: Create Reception
      tags:
      - Reception
  /register:
    post:
      consumes:
      - application/json
      description: Creates a new user with role and returns created user data.
      operationId: Register
      parameters:
      - description: User registration payload
        in: body
        name: input
        required: true
        schema:
          $ref: '#/definitions/auth.RegisterRequest'
      produces:
      - application/json
      responses:
        "201":
          description: User successfully created
          schema:
            $ref: '#/definitions/auth.RegisterResponse'
        "400":
          description: Invalid request or validation failed
          schema:
            $ref: '#/definitions/response.Error'
        "409":
          description: Email already exists
          schema:
            $ref: '#/definitions/response.Error'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/response.Error'
      summary: Register new user
      tags:
      - Auth
securityDefinitions:
  ApiKeyAuth:
    description: 'JWT Bearer authentication. The API enforces role-based authorization
      with two roles: moderator and employee.'
    in: header
    name: Authorization
    type: apiKey
swagger: "2.0"
